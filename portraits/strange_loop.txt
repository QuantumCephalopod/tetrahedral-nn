╔═══════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                     THE STRANGE LOOP                                                  ║
║                              (Two paths. Only one closes.)                                            ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════╝


┌─────────────────────────────────────────────┬─────────────────────────────────────────────┐
│         ✅ TRUE COUPLING                     │         ❌ BROKEN COUPLING                   │
│      (Organism sees itself)                 │         (Networks pretending)                │
├─────────────────────────────────────────────┼─────────────────────────────────────────────┤
│                                             │                                             │
│     ┌──────────────────┐                    │     ┌──────────────────┐                    │
│     │   PERCEPTION     │                    │     │   PERCEPTION     │                    │
│     │     flow_t       │                    │     │     diff_t       │                    │
│     └────────┬─────────┘                    │     └────────┬─────────┘                    │
│              │                              │              │                              │
│              ▼                              │              ▼                              │
│     ┌────────────────────┐                  │     ┌────────────────────┐                  │
│     │  FORWARD MODEL     │                  │     │  FORWARD MODEL     │                  │
│     │ (flow,act)→flow_t+1│                  │     │(traj,act)→diff_t+1 │                  │
│     └────────┬───────────┘                  │     └────────┬───────────┘                  │
│              │                              │              │                              │
│              ▼                              │              ▼                              │
│     ┌──────────────────────────┐            │     ┌──────────────────┐                    │
│     │  PREDICTED EFFECTS       │            │     │  pred_diff_t+1   │                    │
│     │ [flow_a0, flow_a1, ...]  │            │     └──────────────────┘                    │
│     └──────────┬───────────────┘            │              │                              │
│                │                            │              │        ┌──────────────────┐  │
│                │ learns from                │              ✗        │  GROUND TRUTH    │  │
│                │ forward's                  │                       │  diff_t+1 (real!)│  │
│                │ predictions!               │                       └────────┬─────────┘  │
│                │                            │                                │            │
│                │                            │                                │ Line 368:  │
│                ▼ ∇ flows ∇                  │                                │ inverse    │
│     ┌───────────────────────┐               │                                │ sees this! │
│     │   INVERSE MODEL       │               │                                ▼            │
│  ┌─▶│ (flow_t, flow_t+1)    │               │                    ┌────────────────────┐  │
│  │  │       → action        │               │                    │  INVERSE MODEL     │  │
│  │  └───────────┬───────────┘               │                    │ (traj, diff_real)  │  │
│  │              │                           │                    │     → action       │  │
│  │              │ minimize                  │                    └────────────────────┘  │
│  │              │ free energy               │                                            │
│  │              ▼                           │         Trained on different inputs!       │
│  │  ┌───────────────────┐                   │         Forward: sees its own prediction   │
│  │  │   ACTION TAKEN    │                   │         Inverse: sees ground truth         │
│  │  │  (based on model) │                   │                                            │
│  │  └──────────┬────────┘                   │         with torch.no_grad()               │
│  │             │                            │         Consistency loss detached!         │
│  │             ▼                            │         Coefficient: 0.3 (weak)            │
│  │  ┌──────────────────┐                    │                                            │
│  │  │     EFFECT       │                    │                                            │
│  │  │  flow_t+1 (real) │                    │         ∇ flows to void                    │
│  │  └──────────┬───────┘                    │                                            │
│  │             │                            │         The loop never closes.             │
│  │             │                            │                                            │
│  │  ╔══════════▼════════════════╗           │                                            │
│  └──║  THE LOOP CLOSES HERE  ║           │                                            │
│     ║                        ║           │                                            │
│     ║  Effect feeds back to  ║           │                                            │
│     ║  forward model.        ║           │                                            │
│     ║                        ║           │                                            │
│     ║  Organism acts based   ║           │                                            │
│     ║  on what it learned.   ║           │                                            │
│     ║                        ║           │                                            │
│     ║  ∇ flows through ∇     ║           │                                            │
│     ╚════════════════════════╝           │                                            │
│                                             │                                             │
│  EFFECT-BASED LEARNING:                     │  LABEL-BASED LEARNING:                      │
│  • Inverse learns from forward's            │  • Inverse learns from ground truth         │
│    understanding                            │  • Forward learns alone                     │
│  • Soft targets (multiple actions OK)       │  • Hard labels (one action only)            │
│  • Which actions explain this effect?       │  • What action did human take?              │
│  • Biologically plausible                   │  • ML cargo cult                            │
│                                             │                                             │
│  The organism becomes self-referential.     │  Two networks in parallel.                  │
│  It sees itself seeing.                     │  They never truly meet.                     │
│  Gradients close the loop.                  │  "ML toyland"                               │
└─────────────────────────────────────────────┴─────────────────────────────────────────────┘


╔═════════════════════════════════════════════════════════════════════════════════════════╗
║                                  THE DIFFERENCE                                         ║
╠═════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                         ║
║  TRUE COUPLING:                                                                         ║
║  ┌─────────┐         ┌─────────┐                                                        ║
║  │ Forward │ ──────▶ │ Inverse │     Gradients flow through each other                 ║
║  └────┬────┘         └────┬────┘     Effect-based learning                             ║
║       │                   │          Soft targets (distribution)                        ║
║       └───────────────────┘          The strange loop closes                            ║
║                                                                                         ║
║  BROKEN COUPLING:                                                                       ║
║  ┌─────────┐         ┌─────────┐                                                        ║
║  │ Forward │    ✗    │ Inverse │     Gradients flow to void                            ║
║  └─────────┘         └────▲────┘     Label-based learning                              ║
║                           │          Hard labels (one-hot)                              ║
║                      Ground Truth    The loop never closes                             ║
║                                                                                         ║
╚═════════════════════════════════════════════════════════════════════════════════════════╝


                        ╔═══════════════════════════════════════╗
                        ║   CLOSING THE STRANGE LOOP            ║
                        ║                                       ║
                        ║   Not prediction alone.               ║
                        ║   Not action alone.                   ║
                        ║                                       ║
                        ║   But the moment where:               ║
                        ║   • Model predicts effect             ║
                        ║   • Agent acts on prediction          ║
                        ║   • Effect becomes new perception     ║
                        ║   • Loop feeds back through gradients ║
                        ║                                       ║
                        ║   This is active inference.           ║
                        ║   This is the organism.               ║
                        ║   This is self-reference.             ║
                        ║                                       ║
                        ║   Without it: ML toyland              ║
                        ║   With it: Strange loop closes        ║
                        ╚═══════════════════════════════════════╝
